/*! Backstretch - v2.0.4 - 2013-06-19
* http://srobbin.com/jquery-plugins/backstretch/
* Copyright (c) 2013 Scott Robbin; Licensed MIT */
(function(d,c,f){d.fn.backstretch=function(g,h){if(g===f||g.length===0){d.error("No images were supplied for Backstretch")}if(d(c).scrollTop()===0){c.scrollTo(0,0)}return this.each(function(){var j=d(this),i=j.data("backstretch");if(i){if(typeof g=="string"&&typeof i[g]=="function"){i[g](h);return}h=d.extend(i.options,h);i.destroy(true)}i=new a(this,g,h);j.data("backstretch",i)})};d.backstretch=function(g,h){return d("body").backstretch(g,h).data("backstretch")};d.expr[":"].backstretch=function(g){return d(g).data("backstretch")!==f};d.fn.backstretch.defaults={centeredX:true,centeredY:true,duration:5000,fade:0,fadeFirstImage:true};var b={wrap:{left:0,top:0,overflow:"hidden",margin:0,padding:0,height:"100%",width:"100%",zIndex:-999999},img:{position:"absolute",display:"none",margin:0,padding:0,border:"none",width:"auto",height:"auto",maxHeight:"none",maxWidth:"none",zIndex:-999999}};var a=function(i,h,k){this.options=d.extend({},d.fn.backstretch.defaults,k||{});this.firstShow=!this.options.fadeFirstImage;this.images=d.isArray(h)?h:[h];d.each(this.images,function(){d("<img />")[0].src=this});this.isBody=i===document.body;this.$container=d(i);this.$root=this.isBody?e?d(c):d(document):this.$container;var j=this.$container.children(".backstretch").first();this.$wrap=j.length?j:d('<div class="backstretch"></div>').css(b.wrap).appendTo(this.$container);if(!this.isBody){var g=this.$container.css("position"),l=this.$container.css("zIndex");this.$container.css({position:g==="static"?"relative":g,zIndex:l==="auto"?0:l,background:"none"});this.$wrap.css({zIndex:-999998})}this.$wrap.css({position:this.isBody&&e?"fixed":"absolute"});this.index=0;this.show(this.index);d(c).on("resize.backstretch",d.proxy(this.resize,this)).on("orientationchange.backstretch",d.proxy(function(){if(this.isBody&&c.pageYOffset===0){c.scrollTo(0,1);this.resize()}},this))};a.prototype={resize:function(){try{var j={left:0,top:0},h=this.isBody?this.$root.width():this.$root.innerWidth(),m=h,i=this.isBody?(c.innerHeight?c.innerHeight:this.$root.height()):this.$root.innerHeight(),g=m/this.$img.data("ratio"),l;if(g>=i){l=(g-i)/2;if(this.options.centeredY){j.top="-"+l+"px"}}else{g=i;m=g*this.$img.data("ratio");l=(m-h)/2;if(this.options.centeredX){j.left="-"+l+"px"}}this.$wrap.css({width:h,height:i}).find("img:not(.deleteable)").css({width:m,height:g}).css(j)}catch(k){}return this},show:function(j){if(Math.abs(j)>this.images.length-1){return}var h=this,i=h.$wrap.find("img").addClass("deleteable"),g={relatedTarget:h.$container[0]};h.$container.trigger(d.Event("backstretch.before",g),[h,j]);this.index=j;clearInterval(h.interval);h.$img=d("<img />").css(b.img).bind("load",function(m){var l=this.width||d(m.target).width(),k=this.height||d(m.target).height();d(this).data("ratio",l/k);h.oldSpeed=h.options.speed;h.oldFade=h.options.fade;if(h.firstShow){h.options.speed=f;h.options.fade=0;h.firstShow=false}d(this).fadeIn(h.options.speed||h.options.fade,function(){h.options.speed=h.oldSpeed;h.options.fade=h.oldFade;i.remove();if(!h.paused){h.cycle()}d(["after","show"]).each(function(){h.$container.trigger(d.Event("backstretch."+this,g),[h,j])})});h.resize()}).appendTo(h.$wrap);h.$img.attr("src",h.images[j]);return h},next:function(){return this.show(this.index<this.images.length-1?this.index+1:0)},prev:function(){return this.show(this.index===0?this.images.length-1:this.index-1)},pause:function(){this.paused=true;return this},resume:function(){this.paused=false;this.next();return this},cycle:function(){if(this.images.length>1){clearInterval(this.interval);this.interval=setInterval(d.proxy(function(){if(!this.paused){this.next()}},this),this.options.duration)}return this},destroy:function(g){d(c).off("resize.backstretch orientationchange.backstretch");clearInterval(this.interval);if(!g){this.$wrap.remove()}this.$container.removeData("backstretch")}};var e=(function(){var h=navigator.userAgent,j=navigator.platform,p=h.match(/AppleWebKit\/([0-9]+)/),n=!!p&&p[1],i=h.match(/Fennec\/([0-9]+)/),l=!!i&&i[1],m=h.match(/Opera Mobi\/([0-9]+)/),g=!!m&&m[1],k=h.match(/MSIE ([0-9]+)/),o=!!k&&k[1];return !(((j.indexOf("iPhone")>-1||j.indexOf("iPad")>-1||j.indexOf("iPod")>-1)&&n&&n<534)||(c.operamini&&({}).toString.call(c.operamini)==="[object OperaMini]")||(m&&g<7458)||(h.indexOf("Android")>-1&&n&&n<533)||(l&&l<6)||("palmGetResource" in c&&n&&n<534)||(h.indexOf("MeeGo")>-1&&h.indexOf("NokiaBrowser/8.5.0")>-1)||(o&&o<=6))}())}(jQuery,window));
