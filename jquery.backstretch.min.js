/*
 * jQuery Backstretch
 * Version 1.1.2
 * http://srobbin.com/jquery-plugins/jquery-backstretch/
 *
 * Add a dynamically-resized background image to the page
 *
 * Copyright (c) 2010 Scott Robbin (srobbin.com)
 * Dual licensed under the MIT and GPL licenses.
*/
(function($){$.backstretch=function(src,options,callback){var settings={centeredX:0.5,centeredY:0.5,speed:0},rootElement=("onorientationchange"in window)?$(document):$(window),imgRatio,bgImg,bgWidth,bgHeight,bgOffset,bgCSS;_parseOptions();$(document).ready(_init);return this;function _parseOptions(){if(options&&typeof options=="object"){$.extend(settings,options);if(settings.centeredX===true){settings.centeredX=0.5;}else if(settings.centeredX===false){settings.centeredX=0;};if(settings.centeredY===true){settings.centeredY=0.5;}else if(settings.centeredY===false){settings.centeredY=0;};if(settings.center!=undefined&&settings.center.constructor==Array){if(settings.center[0]!=undefined){settings.centeredX=settings.center[0];};if(settings.center[1]!=undefined){settings.centeredY=settings.center[1];}}}};function _init(){if(src){var container=$("<div />").attr("class","backstretch").css({left:0,top:0,position:"fixed",overflow:"hidden",zIndex:-9999}),img=$("<img />").css({position:"relative",display:"none"}).bind("load",function(e){var self=$(this);imgRatio=$(e.target).width()/$(e.target).height();_adjustBG(function(){self.fadeIn(settings.speed,function(){if(typeof callback=="function")callback();});});}).appendTo(container);$("body").prepend(container);img.attr("src",src);$(window).resize(_adjustBG);}};function _adjustBG(fn){try{bgCSS={left:0,top:0};bgWidth=rootElement.width();bgHeight=bgWidth/imgRatio;if(bgHeight>=rootElement.height()){if(settings.centeredY>0){bgOffset=(bgHeight-rootElement.height())*settings.centeredY;$.extend(bgCSS,{top:"-"+bgOffset+"px"});}}else{bgHeight=rootElement.height();bgWidth=bgHeight*imgRatio;if(settings.centeredX>0){bgOffset=(bgWidth-rootElement.width())*settings.centeredX;$.extend(bgCSS,{left:"-"+bgOffset+"px"});}};$(".backstretch img").width(bgWidth).height(bgHeight).css(bgCSS);}catch(err){};if(typeof fn=="function")fn();}};})(jQuery);